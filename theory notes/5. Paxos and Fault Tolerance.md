```mermaid
flowchart TD
  init([Init])-->|Send prep|wpp(Wait for f+1)
  wpp-->|at least f+1|p(Prepared)
  p-->|Send commit|wp(Wait for f+1)
  wp-->|at least f+1|c(Committed)
  c-->fin([Complete])
  wpp-->to([Timeout])
  wp-->to
  to-->|restart|init
```
